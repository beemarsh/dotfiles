
#!/usr/bin/env python3

import subprocess as sp

def get_clipboard_content():
    try:
        result = sp.run(['xclip', '-selection', 'clipboard', '-o'], stdout=sp.PIPE, stderr=sp.PIPE, check=True, encoding='utf-8')
        return result.stdout.strip()
    except sp.CalledProcessError as e:
        print(f"Error retrieving clipboard content: {e}")
        return ''

if __name__ == '__main__':
    clipboard_content = get_clipboard_content()

    if clipboard_content:
        title = 'rofi-xclip'
        rofi = f'rofi -dmenu -i -p {title} -format i'.split()
        rofi_input = clipboard_content

        p = sp.run(rofi, input=rofi_input, encoding='utf-8', stdout=sp.PIPE, stderr=sp.PIPE)
        if p.returncode == 0:
            selected_item = p.stdout.strip()
            sp.run(['echo', '-n', selected_item.strip()+' | xclip -selection clipboard'], shell=True)
